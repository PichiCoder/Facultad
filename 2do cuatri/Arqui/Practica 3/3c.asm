;PIC
EOI EQU 20H
IMR EQU 21H
INT0 EQU 24H ;para F10
INT1 EQU 25H ;para el Timer
INT2 EQU 26H ;para impresora
;hasta INT7 en 2BH

POS_VECTOR_IMPRESORA EQU 20

;HANDSHAKE
DATO EQU 40H
ESTADO EQU 41H

ORG 80H
DIR_RUT_IMPRESORA DW RUT_IMPRESORA

ORG 3000H
RUT_IMPRESORA: PUSH AX
;
MOV AL, [BX]
OUT DATO, AL
INC BX
DEC CL
;
MOV AL, 20H
OUT EOI, AL
POP AX
 IRET

ORG 1000H
str DB "UNIVERSIDAD NACIONAL DE LA PLATA"
fin db ?

ORG 2000H
CLI
;CONFIG DEL PIC
MOV AL, 11111011b ; 1111 1011 al IMR 
OUT IMR, AL
MOV AL, POS_VECTOR_IMPRESORA
OUT INT2, AL

MOV BX, OFFSET str
MOV CL, OFFSET fin - OFFSET str
STI

; Configuro el Handshake para interrupcion
IN AL, ESTADO ; Tomo estado actual
OR AL, 80H ; 80H = 10000000
OUT ESTADO, AL ; Estado = 1xxxxxxx

loop: CMP CL, 0
JNZ loop

INT 0
END
